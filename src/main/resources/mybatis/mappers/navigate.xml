<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"> 

<mapper namespace="navigate">

	<select id="navigate" resultType="java.util.LinkedHashMap" >
		select nhdplus_navigation.navigate(                
             pnavigationtype           := <choose><when test="navigationMode != null">#{navigationMode,jdbcType=VARCHAR}</when><otherwise>'UT'</otherwise></choose>     
            ,pstartcomid               := <choose><when test="comid != null">#{comid,jdbcType=NUMERIC}</when><otherwise>null</otherwise></choose>
            ,pstartpermanentidentifier := null     
            ,pstartreachcode           := null     
            ,pstartmeasure             := null
            ,pstopcomid                := <choose><when test="stopComid != null">#{stopComid,jdbcType=NUMERIC}</when><otherwise>null</otherwise></choose>     
            ,pstoppermanentidentifier  := null     
            ,pstopreachcode            := null     
            ,pstopmeasure              := null    
            ,pmaxdistancekm            := <choose><when test="distance != null">#{distance,jdbcType=NUMERIC}</when><otherwise>null</otherwise></choose>   
            ,pmaxflowtimehour          := null     
            ,pdebug                    := 'FALSE'   
            ,paddflowlineattributes    := 'TRUE'  
            ,paddflowlinegeometry      := 'TRUE'  
         );
	</select>

    <select id="select" resultType="java.util.LinkedHashMap" fetchSize="500">
        select nhdplus_comid,
        	   st_asgeojson(shape) shape
          from nhdplus_navigation.tmp_navigation_results
         where session_id = #{sessionId}
            order by totaldist, hydroseq
     </select>

</mapper>       